<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOGUE | 雲端預約系統</title>
    <style>
        :root { --gold: #d4af37; --bg: #0a0a0a; }
        body { background: var(--bg); color: #fff; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: #111; border: 1px solid var(--gold); border-radius: 15px; padding: 20px; width: 90%; max-width: 400px; margin-bottom: 20px; }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #333; box-sizing: border-box; }
        button { background: var(--gold); color: #000; font-weight: bold; cursor: pointer; border: none; }
        .booking-item { background: #1a1a1a; padding: 15px; border-left: 5px solid var(--gold); margin-bottom: 10px; border-radius: 5px; }
    </style>
</head>
<body>

    <h1 style="color:var(--gold);">VOGUE 雲端預約</h1>

    <div class="card">
        <input type="text" id="custName" placeholder="顧客姓名">
        <select id="custService">
            <option value="染髮設計">染髮設計</option>
            <option value="剪髮造型">剪髮造型</option>
        </select>
        <input type="date" id="appDate">
        <input type="time" id="appTime">
        <button onclick="saveToCloud()">送出預約 (同步雲端)</button>
    </div>

    <div id="admin-panel" style="width: 90%; max-width: 400px;">
        <h3 style="color:var(--gold); border-bottom: 1px solid #333;">設計師後台 (即時清單)</h3>
        <div id="booking-list">載入中...</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, query, orderByChild } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // *** 請在此處替換為您的 Firebase 專案設定 ***
        const firebaseConfig = {
            apiKey: "您的API金鑰",
            authDomain: "booking-af275.firebaseapp.com",
            databaseURL: "https://booking-af275-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "booking-af275",
            storageBucket: "booking-af275.appspot.com",
            messagingSenderId: "您的傳送ID",
            appId: "您的AppID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const bookingRef = ref(db, 'vogue_bookings');

        // 客人存檔功能
        window.saveToCloud = function() {
            const name = document.getElementById('custName').value;
            const service = document.getElementById('custService').value;
            const time = document.getElementById('appDate').value + ' ' + document.getElementById('appTime').value;

            if(!name || !time) return alert("請填寫完整");

            push(bookingRef, {
                name: name,
                service: service,
                time: time,
                createdAt: Date.now()
            }).then(() => {
                alert("預約已存入雲端！您現在可以查看下方清單。");
            });
        };

        // 設計師自動讀取功能 (這就是您要的功能！)
        onValue(bookingRef, (snapshot) => {
            const listDiv = document.getElementById('booking-list');
            listDiv.innerHTML = "";
            const data = snapshot.val();
            
            if (!data) {
                listDiv.innerHTML = "目前尚無預約。";
                return;
            }

            // 將資料轉成陣列並排序
            const sortedItems = Object.values(data).sort((a, b) => b.createdAt - a.createdAt);

            sortedItems.forEach(item => {
                listDiv.innerHTML += `
                    <div class="booking-item">
                        <strong>${item.name}</strong> - ${item.service}<br>
                        <small style="color:#888;">預約時間：${item.time}</small>
                    </div>
                `;
            });
        });
    </script>
</body>
</html>
